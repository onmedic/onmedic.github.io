"use strict";function initSmoothScroll(){document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();const t=this.getAttribute("href").substring(1),n=document.getElementById(t);if(n){const e=document.querySelector(".header").offsetHeight,o=n.offsetTop-e;window.scrollTo({top:o,behavior:"smooth"}),"undefined"!=typeof gtag&&gtag("event","click",{event_category:"Navigation",event_label:t})}})})}function initScrollEffects(){const e=document.querySelector(".header"),t=document.querySelector(".hero");let n=window.scrollY;const o=document.createElement("div");function r(){const r=window.scrollY,i=(t.offsetHeight,document.documentElement.scrollHeight-window.innerHeight);r>100?(e.style.background="rgba(255, 255, 255, 0.98)",e.style.boxShadow="0 2px 20px rgba(10, 35, 66, 0.15)"):(e.style.background="rgba(255, 255, 255, 0.95)",e.style.boxShadow="0 2px 20px rgba(10, 35, 66, 0.06)");const s=r/i*100;o.style.width=`${Math.min(s,100)}%`,e.style.transform="translateY(0)",n=r}let i;o.className="scroll-progress",o.style.cssText="\n        position: fixed;\n        top: 0;\n        left: 0;\n        width: 0%;\n        height: 3px;\n        background: linear-gradient(90deg, var(--color-accent), var(--color-primary));\n        z-index: 1001;\n        transition: width 0.1s ease;\n    ",document.body.appendChild(o),window.addEventListener("scroll",function(){i&&cancelAnimationFrame(i),i=requestAnimationFrame(r)},{passive:!0})}function initFormHandling(){const e=document.querySelector(".contact-form"),t=e.querySelector('button[type="submit"]'),n=t.innerHTML,o=e.querySelectorAll("input, textarea");function r(e){const t=e.target,n=t.value.trim();if(t.classList.remove("error"),t.required&&!n)return i(t,"Aquest camp és obligatori"),!1;if("email"===t.type&&n){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n))return i(t,"Introduïu un email vàlid"),!1}return!0}function i(e,t){if(e.classList.add("error"),!document.querySelector(".error-styles")){const e=document.createElement("style");e.className="error-styles",e.textContent="\n                .form-group input.error,\n                .form-group textarea.error {\n                    border-color: #ff6b6b;\n                    box-shadow: 0 0 0 2px rgba(255, 107, 107, 0.2);\n                }\n            ",document.head.appendChild(e)}}function s(e){e.target.classList.remove("error")}o.forEach(e=>{e.addEventListener("blur",r),e.addEventListener("input",s)}),e.addEventListener("submit",async function(i){i.preventDefault();let s=!0;if(o.forEach(e=>{r({target:e})||(s=!1)}),s){t.disabled=!0,t.innerHTML='\n            <span>Enviant...</span>\n            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n                <circle cx="12" cy="12" r="3"/>\n                <path d="m12 1 0 6m0 6 0 6m-6-6 6 0m6 0-6 0"/>\n            </svg>\n        ';try{const t=new FormData(e);if(!(await fetch(e.action,{method:"POST",body:t,headers:{Accept:"application/json"}})).ok)throw new Error("Error en enviar el formulari");!function(){const e=document.createElement("div");e.className="form-message success",e.style.cssText="\n            position: fixed;\n            top: 2rem;\n            right: 2rem;\n            background: #10b981;\n            color: white;\n            padding: 1rem 1.5rem;\n            border-radius: 8px;\n            box-shadow: 0 10px 40px rgba(16, 185, 129, 0.3);\n            z-index: 1000;\n            animation: slideInRight 0.3s ease;\n        ",e.innerHTML="✅ Missatge enviat correctament! Ens posarem en contacte aviat.",document.body.appendChild(e),setTimeout(()=>{e.style.animation="slideOutRight 0.3s ease",setTimeout(()=>e.remove(),300)},5e3)}(),e.reset(),"undefined"!=typeof gtag&&gtag("event","form_submit",{event_category:"Contact",event_label:"Success"})}catch(e){!function(){const e=document.createElement("div");e.className="form-message error",e.style.cssText="\n            position: fixed;\n            top: 2rem;\n            right: 2rem;\n            background: #ef4444;\n            color: white;\n            padding: 1rem 1.5rem;\n            border-radius: 8px;\n            box-shadow: 0 10px 40px rgba(239, 68, 68, 0.3);\n            z-index: 1000;\n            animation: slideInRight 0.3s ease;\n        ",e.innerHTML="❌ Error en enviar el missatge. Torneu-ho a provar.",document.body.appendChild(e),setTimeout(()=>{e.style.animation="slideOutRight 0.3s ease",setTimeout(()=>e.remove(),300)},5e3)}(),console.error("Form submission error:",e),"undefined"!=typeof gtag&&gtag("event","exception",{description:"Form submission error",fatal:!1})}finally{setTimeout(()=>{t.disabled=!1,t.innerHTML=n},2e3)}}})}function initPerformanceOptimizations(){if("IntersectionObserver"in window){const e=document.querySelectorAll("img[data-src]"),t=new IntersectionObserver((e,t)=>{e.forEach(e=>{if(e.isIntersecting){const n=e.target;n.src=n.dataset.src,n.classList.remove("lazy"),t.unobserve(n)}})});e.forEach(e=>t.observe(e))}["/src/styles/main.css","/src/scripts/animations.js"].forEach(e=>{const t=document.createElement("link");t.rel="prefetch",t.href=e,document.head.appendChild(t)})}function initAccessibility(){const e=document.createElement("a");e.className="skip-link",e.href="#hero",e.textContent="Anar al contingut principal",e.style.cssText="\n        position: absolute;\n        top: -40px;\n        left: 6px;\n        background: var(--color-primary);\n        color: white;\n        padding: 8px;\n        text-decoration: none;\n        border-radius: 4px;\n        z-index: 1000;\n        transition: top 0.3s;\n    ",e.addEventListener("focus",function(){this.style.top="6px"}),e.addEventListener("blur",function(){this.style.top="-40px"}),document.body.insertBefore(e,document.body.firstChild),document.addEventListener("keydown",function(e){if("Escape"===e.key){const e=document.activeElement;e&&e.blur&&e.blur()}}),window.announceToScreenReader=function(e){const t=document.createElement("div");t.setAttribute("aria-live","polite"),t.setAttribute("aria-atomic","true"),t.style.cssText="\n            position: absolute;\n            left: -10000px;\n            width: 1px;\n            height: 1px;\n            overflow: hidden;\n        ",t.textContent=e,document.body.appendChild(t),setTimeout(()=>{document.body.removeChild(t)},1e3)}}document.addEventListener("DOMContentLoaded",function(){initSmoothScroll(),initScrollEffects(),initFormHandling(),initPerformanceOptimizations(),initAccessibility()});const style=document.createElement("style");style.textContent="\n    @keyframes slideInRight {\n        from {\n            transform: translateX(100%);\n            opacity: 0;\n        }\n        to {\n            transform: translateX(0);\n            opacity: 1;\n        }\n    }\n    \n    @keyframes slideOutRight {\n        from {\n            transform: translateX(0);\n            opacity: 1;\n        }\n        to {\n            transform: translateX(100%);\n            opacity: 0;\n        }\n    }\n",document.head.appendChild(style);
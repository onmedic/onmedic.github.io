<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üö® FORCE FIX - Expertesa Text Visibility</title>
    <style>
        body {
            font-family: monospace;
            background: #0a0a0a;
            color: #00ff00;
            padding: 20px;
            line-height: 1.6;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: #111;
            padding: 30px;
            border-radius: 10px;
            border: 2px solid #00ff00;
        }
        h1 {
            color: #ff0000;
            text-align: center;
            margin-bottom: 30px;
        }
        .action {
            background: #222;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            border: 1px solid #333;
        }
        .button {
            display: inline-block;
            padding: 15px 30px;
            margin: 10px;
            background: #333;
            color: #00ff00;
            border: 2px solid #00ff00;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .button:hover {
            background: #00ff00;
            color: #000;
        }
        .button.danger {
            border-color: #ff0000;
            color: #ff0000;
        }
        .button.danger:hover {
            background: #ff0000;
            color: #fff;
        }
        .log {
            background: #0a0a0a;
            padding: 15px;
            margin: 20px 0;
            border-radius: 5px;
            border: 1px solid #333;
            max-height: 300px;
            overflow-y: auto;
            font-size: 12px;
        }
        .success { color: #00ff00; }
        .error { color: #ff0000; }
        .warning { color: #ffaa00; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üö® FORCE FIX - Expertesa Text Problem</h1>
        
        <div class="action">
            <h3>üéØ Quick Action</h3>
            <p>Go directly to the Catalan page with cache-busting:</p>
            <a href="/ca/?fix=1&v=2025082218&nocache=true" class="button" target="_blank">üîó Open /ca/ with Cache Clear</a>
        </div>
        
        <div class="action">
            <h3>‚ö° Force Apply Fix</h3>
            <p>Apply the fix directly via JavaScript:</p>
            <div class="button" onclick="applyDirectFix()">üîß Apply Direct Fix</div>
        </div>
        
        <div class="action">
            <h3>üîç Test Current State</h3>
            <p>Check if the fix is working:</p>
            <div class="button" onclick="testExpertiseText()">üß™ Test Expertise Text</div>
        </div>
        
        <div class="action">
            <h3>üö® Nuclear Option</h3>
            <p>Clear everything and redirect:</p>
            <div class="button danger" onclick="nuclearFix()">üí• Nuclear Fix</div>
        </div>
        
        <div class="log" id="log"></div>
        
        <div class="action">
            <h3>üìã Expected Result</h3>
            <p>After applying the fix, you should see these 6 cards with visible text:</p>
            <ol style="color: #ffaa00;">
                <li><strong>Entendre les Dades M√®diques</strong> - Dades als hospitals ordenades i comprensibles</li>
                <li><strong>Seguretat de Veritat</strong> - GDPR, HIPAA compliance</li>
                <li><strong>Del Paper al Digital (Sense Por)</strong> - Transici√≥ digital acompanyada</li>
                <li><strong>Hospitals Que Funcionen Millor</strong> - Connectar tot el sistema hospitalari</li>
                <li><strong>Bluesky i YouTube? Els Dominem!</strong> - Plataformes socials</li>
                <li><strong>Apps Per a Tot i Tothom</strong> - Cross-platform development</li>
            </ol>
        </div>
    </div>

    <script>
        const log = (message, type = 'info') => {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type === 'error' ? 'error' : type === 'warning' ? 'warning' : 'success';
            logDiv.innerHTML += `<div class="${className}">[${timestamp}] ${message}</div>`;
            logDiv.scrollTop = logDiv.scrollHeight;
            console.log(`FORCE_FIX: ${message}`);
        };

        function applyDirectFix() {
            log('üîß Applying direct fix via postMessage...', 'info');
            
            // Try to communicate with /ca/ page if it's open
            const caWindow = window.open('/ca/', 'caPage');
            
            setTimeout(() => {
                const fixScript = `
                    console.log('üö® DIRECT FIX: Applying expertise text fix...');
                    
                    const expertiseCards = document.querySelectorAll('.expertise-card');
                    console.log('Found cards:', expertiseCards.length);
                    
                    expertiseCards.forEach((card, index) => {
                        const h3 = card.querySelector('h3');
                        const p = card.querySelector('p');
                        
                        if (h3) {
                            h3.style.cssText = 'color: #ffffff !important; display: block !important; visibility: visible !important; font-family: "Space Grotesk", -apple-system, BlinkMacSystemFont, sans-serif !important; font-size: 1.4rem !important; font-weight: 600 !important; margin-bottom: 1rem !important; opacity: 1 !important;';
                            console.log('Fixed h3 for card ' + (index + 1) + ': "' + h3.textContent + '"');
                        }
                        
                        if (p) {
                            p.style.cssText = 'color: rgba(255,255,255,0.8) !important; display: block !important; visibility: visible !important; font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif !important; line-height: 1.6 !important; opacity: 1 !important;';
                            console.log('Fixed p for card ' + (index + 1));
                        }
                        
                        card.style.background = 'rgba(255,255,255,0.1)';
                        card.style.padding = '2.5rem 2rem';
                        card.style.textAlign = 'center';
                    });
                    
                    console.log('‚úÖ Direct fix applied!');
                    
                    // Scroll to expertise section
                    const expertiseSection = document.querySelector('#expertise');
                    if (expertiseSection) {
                        expertiseSection.scrollIntoView({ behavior: 'smooth' });
                    }
                `;
                
                try {
                    caWindow.eval(fixScript);
                    log('‚úÖ Fix applied successfully to /ca/ page!', 'success');
                } catch (error) {
                    log('‚ùå Could not apply fix: ' + error.message, 'error');
                    log('üí° Try opening /ca/ manually and run the fix', 'warning');
                }
            }, 2000);
        }

        function testExpertiseText() {
            log('üß™ Testing current expertise text visibility...', 'info');
            
            // Open /ca/ page to test
            const testWindow = window.open('/ca/', 'testPage');
            
            setTimeout(() => {
                try {
                    const cards = testWindow.document.querySelectorAll('.expertise-card');
                    log(`Found ${cards.length} expertise cards`, 'info');
                    
                    let visibleTexts = 0;
                    cards.forEach((card, index) => {
                        const h3 = card.querySelector('h3');
                        const p = card.querySelector('p');
                        
                        if (h3 && h3.textContent.trim()) {
                            const styles = testWindow.getComputedStyle(h3);
                            const isVisible = styles.visibility === 'visible' && 
                                            styles.display !== 'none' && 
                                            styles.opacity !== '0';
                            
                            log(`Card ${index + 1} H3: "${h3.textContent}" - ${isVisible ? '‚úÖ Visible' : '‚ùå Hidden'}`, 
                                isVisible ? 'success' : 'error');
                            
                            if (isVisible) visibleTexts++;
                        }
                    });
                    
                    if (visibleTexts === cards.length) {
                        log('üéâ SUCCESS! All expertise texts are visible!', 'success');
                    } else {
                        log(`‚ö†Ô∏è Only ${visibleTexts}/${cards.length} texts are visible`, 'warning');
                    }
                    
                } catch (error) {
                    log('‚ùå Could not test: ' + error.message, 'error');
                }
            }, 3000);
        }

        function nuclearFix() {
            log('üí• NUCLEAR OPTION: Clearing all cache and redirecting...', 'error');
            
            // Clear all possible cache
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(registrations => {
                    registrations.forEach(reg => reg.unregister());
                });
            }
            
            if ('caches' in window) {
                caches.keys().then(names => {
                    names.forEach(name => caches.delete(name));
                });
            }
            
            localStorage.clear();
            sessionStorage.clear();
            
            // Redirect with maximum cache busting
            setTimeout(() => {
                const url = `/ca/index.html?fix=nuclear&v=${Date.now()}&bust=${Math.random()}&force=1`;
                window.location.href = url;
            }, 2000);
        }

        // Auto log on load
        window.addEventListener('load', () => {
            log('üöÄ Force Fix tool loaded', 'info');
            log('Select an action above to fix the expertise text issue', 'info');
        });
    </script>
</body>
</html>